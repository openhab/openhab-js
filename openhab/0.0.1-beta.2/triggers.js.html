<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>triggers.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="ConditionBuilder.html">ConditionBuilder</a><ul class='methods'><li data-type='method'><a href="ConditionBuilder.html#stateOfItem">stateOfItem</a></li><li data-type='method'><a href="ConditionBuilder.html#then">then</a></li></ul></li><li><a href="ConditionBuilder.ConditionConf.html">ConditionConf</a><ul class='methods'><li data-type='method'><a href="ConditionBuilder.ConditionConf.html#then">then</a></li></ul></li><li><a href="ConditionBuilder.FunctionConditionConf.html">FunctionConditionConf</a><ul class='methods'><li data-type='method'><a href="ConditionBuilder.FunctionConditionConf.html#then">then</a></li></ul></li><li><a href="ConditionBuilder.ItemStateConditionConf.html">ItemStateConditionConf</a><ul class='methods'><li data-type='method'><a href="ConditionBuilder.ItemStateConditionConf.html#in">in</a></li><li data-type='method'><a href="ConditionBuilder.ItemStateConditionConf.html#is">is</a></li><li data-type='method'><a href="ConditionBuilder.ItemStateConditionConf.html#then">then</a></li></ul></li><li><a href="items.OHItem.html">OHItem</a><ul class='methods'><li data-type='method'><a href="items.OHItem.html#addGroups">addGroups</a></li><li data-type='method'><a href="items.OHItem.html#addTags">addTags</a></li><li data-type='method'><a href="items.OHItem.html#getMetadataValue">getMetadataValue</a></li><li data-type='method'><a href="items.OHItem.html#postUpdate">postUpdate</a></li><li data-type='method'><a href="items.OHItem.html#removeGroups">removeGroups</a></li><li data-type='method'><a href="items.OHItem.html#removeTags">removeTags</a></li><li data-type='method'><a href="items.OHItem.html#sendCommand">sendCommand</a></li><li data-type='method'><a href="items.OHItem.html#sendCommandIfDifferent">sendCommandIfDifferent</a></li><li data-type='method'><a href="items.OHItem.html#updateMetadataValue">updateMetadataValue</a></li><li data-type='method'><a href="items.OHItem.html#updateMetadataValues">updateMetadataValues</a></li><li data-type='method'><a href="items.OHItem.html#upsertMetadataValue">upsertMetadataValue</a></li></ul></li><li><a href="log.Logger.html">Logger</a><ul class='methods'><li data-type='method'><a href="log.Logger.html#atLevel">atLevel</a></li><li data-type='method'><a href="log.Logger.html#debug">debug</a></li><li data-type='method'><a href="log.Logger.html#error">error</a></li><li data-type='method'><a href="log.Logger.html#info">info</a></li><li data-type='method'><a href="log.Logger.html#trace">trace</a></li><li data-type='method'><a href="log.Logger.html#warn">warn</a></li></ul></li><li><a href="OperationBuilder.html">OperationBuilder</a><ul class='methods'><li data-type='method'><a href="OperationBuilder.html#build">build</a></li><li data-type='method'><a href="OperationBuilder.html#copyAndSendState">copyAndSendState</a></li><li data-type='method'><a href="OperationBuilder.html#copyState">copyState</a></li><li data-type='method'><a href="OperationBuilder.html#inGroup">inGroup</a></li><li data-type='method'><a href="OperationBuilder.html#postIt">postIt</a></li><li data-type='method'><a href="OperationBuilder.html#postUpdate">postUpdate</a></li><li data-type='method'><a href="OperationBuilder.html#send">send</a></li><li data-type='method'><a href="OperationBuilder.html#sendIt">sendIt</a></li><li data-type='method'><a href="OperationBuilder.html#sendOff">sendOff</a></li><li data-type='method'><a href="OperationBuilder.html#sendOn">sendOn</a></li><li data-type='method'><a href="OperationBuilder.html#sendToggle">sendToggle</a></li></ul></li><li><a href="OperationBuilder.CopyStateOperation.html">CopyStateOperation</a><ul class='methods'><li data-type='method'><a href="OperationBuilder.CopyStateOperation.html#and">and</a></li><li data-type='method'><a href="OperationBuilder.CopyStateOperation.html#build">build</a></li><li data-type='method'><a href="OperationBuilder.CopyStateOperation.html#fromItem">fromItem</a></li><li data-type='method'><a href="OperationBuilder.CopyStateOperation.html#inGroup">inGroup</a></li><li data-type='method'><a href="OperationBuilder.CopyStateOperation.html#toItem">toItem</a></li></ul></li><li><a href="OperationBuilder.OperationConfig.html">OperationConfig</a><ul class='methods'><li data-type='method'><a href="OperationBuilder.OperationConfig.html#build">build</a></li><li data-type='method'><a href="OperationBuilder.OperationConfig.html#inGroup">inGroup</a></li></ul></li><li><a href="OperationBuilder.SendCommandOrUpdateOperation.html">SendCommandOrUpdateOperation</a><ul class='methods'><li data-type='method'><a href="OperationBuilder.SendCommandOrUpdateOperation.html#and">and</a></li><li data-type='method'><a href="OperationBuilder.SendCommandOrUpdateOperation.html#build">build</a></li><li data-type='method'><a href="OperationBuilder.SendCommandOrUpdateOperation.html#inGroup">inGroup</a></li><li data-type='method'><a href="OperationBuilder.SendCommandOrUpdateOperation.html#toItem">toItem</a></li><li data-type='method'><a href="OperationBuilder.SendCommandOrUpdateOperation.html#toItems">toItems</a></li></ul></li><li><a href="OperationBuilder.TimingItemStateOperation.html">TimingItemStateOperation</a><ul class='methods'><li data-type='method'><a href="OperationBuilder.TimingItemStateOperation.html#build">build</a></li><li data-type='method'><a href="OperationBuilder.TimingItemStateOperation.html#inGroup">inGroup</a></li></ul></li><li><a href="OperationBuilder.ToggleOperation.html">ToggleOperation</a><ul class='methods'><li data-type='method'><a href="OperationBuilder.ToggleOperation.html#build">build</a></li><li data-type='method'><a href="OperationBuilder.ToggleOperation.html#doToggle">doToggle</a></li><li data-type='method'><a href="OperationBuilder.ToggleOperation.html#inGroup">inGroup</a></li></ul></li><li><a href="RuleBuilder.html">RuleBuilder</a><ul class='methods'><li data-type='method'><a href="RuleBuilder.html#when">when</a></li></ul></li><li><a href="TriggerBuilder.html">TriggerBuilder</a><ul class='methods'><li data-type='method'><a href="TriggerBuilder.html#channel">channel</a></li><li data-type='method'><a href="TriggerBuilder.html#cron">cron</a></li><li data-type='method'><a href="TriggerBuilder.html#item">item</a></li><li data-type='method'><a href="TriggerBuilder.html#memberOf">memberOf</a></li><li data-type='method'><a href="TriggerBuilder.html#system">system</a></li><li data-type='method'><a href="TriggerBuilder.html#thing">thing</a></li></ul></li><li><a href="TriggerBuilder.ChannelTriggerConfig.html">ChannelTriggerConfig</a><ul class='methods'><li data-type='method'><a href="TriggerBuilder.ChannelTriggerConfig.html#if">if</a></li><li data-type='method'><a href="TriggerBuilder.ChannelTriggerConfig.html#or">or</a></li><li data-type='method'><a href="TriggerBuilder.ChannelTriggerConfig.html#then">then</a></li><li data-type='method'><a href="TriggerBuilder.ChannelTriggerConfig.html#to">to</a></li><li data-type='method'><a href="TriggerBuilder.ChannelTriggerConfig.html#triggered">triggered</a></li></ul></li><li><a href="TriggerBuilder.CronTriggerConfig.html">CronTriggerConfig</a><ul class='methods'><li data-type='method'><a href="TriggerBuilder.CronTriggerConfig.html#if">if</a></li><li data-type='method'><a href="TriggerBuilder.CronTriggerConfig.html#or">or</a></li><li data-type='method'><a href="TriggerBuilder.CronTriggerConfig.html#then">then</a></li></ul></li><li><a href="TriggerBuilder.ItemTriggerConfig.html">ItemTriggerConfig</a><ul class='methods'><li data-type='method'><a href="TriggerBuilder.ItemTriggerConfig.html#changed">changed</a></li><li data-type='method'><a href="TriggerBuilder.ItemTriggerConfig.html#for">for</a></li><li data-type='method'><a href="TriggerBuilder.ItemTriggerConfig.html#from">from</a></li><li data-type='method'><a href="TriggerBuilder.ItemTriggerConfig.html#if">if</a></li><li data-type='method'><a href="TriggerBuilder.ItemTriggerConfig.html#or">or</a></li><li data-type='method'><a href="TriggerBuilder.ItemTriggerConfig.html#receivedCommand">receivedCommand</a></li><li data-type='method'><a href="TriggerBuilder.ItemTriggerConfig.html#receivedUpdate">receivedUpdate</a></li><li data-type='method'><a href="TriggerBuilder.ItemTriggerConfig.html#then">then</a></li><li data-type='method'><a href="TriggerBuilder.ItemTriggerConfig.html#to">to</a></li><li data-type='method'><a href="TriggerBuilder.ItemTriggerConfig.html#toOff">toOff</a></li><li data-type='method'><a href="TriggerBuilder.ItemTriggerConfig.html#toOn">toOn</a></li></ul></li><li><a href="TriggerBuilder.SystemTriggerConfig.html">SystemTriggerConfig</a><ul class='methods'><li data-type='method'><a href="TriggerBuilder.SystemTriggerConfig.html#if">if</a></li><li data-type='method'><a href="TriggerBuilder.SystemTriggerConfig.html#or">or</a></li><li data-type='method'><a href="TriggerBuilder.SystemTriggerConfig.html#ruleEngineStarted">ruleEngineStarted</a></li><li data-type='method'><a href="TriggerBuilder.SystemTriggerConfig.html#rulesLoaded">rulesLoaded</a></li><li data-type='method'><a href="TriggerBuilder.SystemTriggerConfig.html#startLevel">startLevel</a></li><li data-type='method'><a href="TriggerBuilder.SystemTriggerConfig.html#startupComplete">startupComplete</a></li><li data-type='method'><a href="TriggerBuilder.SystemTriggerConfig.html#then">then</a></li><li data-type='method'><a href="TriggerBuilder.SystemTriggerConfig.html#thingsInitialized">thingsInitialized</a></li><li data-type='method'><a href="TriggerBuilder.SystemTriggerConfig.html#userInterfacesStarted">userInterfacesStarted</a></li></ul></li><li><a href="TriggerBuilder.ThingTriggerConfig.html">ThingTriggerConfig</a><ul class='methods'><li data-type='method'><a href="TriggerBuilder.ThingTriggerConfig.html#changed">changed</a></li><li data-type='method'><a href="TriggerBuilder.ThingTriggerConfig.html#from">from</a></li><li data-type='method'><a href="TriggerBuilder.ThingTriggerConfig.html#if">if</a></li><li data-type='method'><a href="TriggerBuilder.ThingTriggerConfig.html#or">or</a></li><li data-type='method'><a href="TriggerBuilder.ThingTriggerConfig.html#then">then</a></li><li data-type='method'><a href="TriggerBuilder.ThingTriggerConfig.html#to">to</a></li><li data-type='method'><a href="TriggerBuilder.ThingTriggerConfig.html#updated">updated</a></li></ul></li><li><a href="TriggerBuilder.TriggerConf.html">TriggerConf</a><ul class='methods'><li data-type='method'><a href="TriggerBuilder.TriggerConf.html#if">if</a></li><li data-type='method'><a href="TriggerBuilder.TriggerConf.html#or">or</a></li><li data-type='method'><a href="TriggerBuilder.TriggerConf.html#then">then</a></li></ul></li></ul><h3>Namespaces</h3><ul><li><a href="actions.html">actions</a></li><li><a href="cache.html">cache</a><ul class='methods'><li data-type='method'><a href="cache.html#.get">get</a></li><li data-type='method'><a href="cache.html#.put">put</a></li><li data-type='method'><a href="cache.html#.remove">remove</a></li></ul></li><li><a href="items.html">items</a><ul class='methods'><li data-type='method'><a href="items.html#.addItem">addItem</a></li><li data-type='method'><a href="items.html#.createItem">createItem</a></li><li data-type='method'><a href="items.html#.getItem">getItem</a></li><li data-type='method'><a href="items.html#.getItemsByTag">getItemsByTag</a></li><li data-type='method'><a href="items.html#.removeItem">removeItem</a></li><li data-type='method'><a href="items.html#.replaceItem">replaceItem</a></li><li data-type='method'><a href="items.html#.safeItemName">safeItemName</a></li></ul></li><li></li><li><a href="log.html">log</a></li><li><a href="osgi.html">osgi</a><ul class='methods'><li data-type='method'><a href="osgi.html#.findServices">findServices</a></li><li data-type='method'><a href="osgi.html#.getService">getService</a></li></ul></li><li><a href="rules.html">rules</a><ul class='methods'><li data-type='method'><a href="rules.html#.JSRule">JSRule</a></li><li data-type='method'><a href="rules.html#.SwitchableJSRule">SwitchableJSRule</a></li><li data-type='method'><a href="rules.html#.when">when</a></li></ul></li><li><a href="triggers.html">triggers</a></li></ul><h3>Global</h3><ul><li><a href="global.html#registeredServices">registeredServices</a></li><li><a href="global.html#upsertValue">upsertValue</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">triggers.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>
/**
 * Triggers namespace.
 * This namespace allows creation of openHAB rule triggers.
 * 
 * @namespace triggers
 */

const utils = require('./utils');

const ModuleBuilder = Java.type("org.openhab.core.automation.util.ModuleBuilder");
const Configuration = Java.type("org.openhab.core.config.core.Configuration");

/**
 * Creates a trigger. Internal function, instead use predefined trigger types.
 * 
 * @memberof triggers
 * @private
 * @param {String} typeString the type of trigger to create
 * @param {String} [name] the name of the trigger
 * @param {Configuration} config the trigger configuration
 */
let createTrigger = function(typeString, name, config) {
    if(typeof name === 'undefined' || name === null) {
        name = utils.randomUUID().toString();
    }

    return ModuleBuilder.createTrigger()
        .withId(name)
        .withTypeUID(typeString)
        .withConfiguration(new Configuration(config))
        .build();
}

module.exports = {

    /**
     * Creates a trigger that fires upon specific events in a channel.
     * 
     * @example
     * ChannelEventTrigger('astro:sun:local:rise#event', 'START')
     * 
     * @name ChannelEventTrigger
     * @memberof triggers
     * @param {String} channel the name of the channel
     * @param {String} event the name of the event to listen for
     * @param {String} [triggerName] the name of the trigger to create
     * 
     */
    ChannelEventTrigger: (channel, event, triggerName) => createTrigger("core.ChannelEventTrigger", triggerName, {
        "channelUID": channel,
        "event": event
    }),

    /**
     * Creates a trigger that fires upon an item changing state.
     * 
     * @example
     * ItemStateChangeTrigger('my_item', 'OFF', 'ON')
     * 
     * @name ItemStateChangeTrigger
     * @memberof triggers
     * @param {String} itemName the name of the item to monitor for change
     * @param {String} [oldState] the previous state of the item
     * @param {String} [newState] the new state of the item
     * @param {String} [triggerName] the name of the trigger to create
     */
    ItemStateChangeTrigger: (itemName, oldState, newState, triggerName) => createTrigger("core.ItemStateChangeTrigger", triggerName, {
        "itemName": itemName,
        "state": newState,
        "oldState": oldState
    }),

    /**
     * Creates a trigger that fires upon an item receiving a state update. Note that the item does not need to change state.
     * 
     * @example
     * ItemStateUpdateTrigger('my_item', 'OFF')
     * 
     * @name ItemStateUpdateTrigger
     * @memberof triggers
     * @param {String} itemName the name of the item to monitor for change
     * @param {String} [state] the new state of the item
     * @param {String} [triggerName] the name of the trigger to create
     */
    ItemStateUpdateTrigger: (itemName, state, triggerName) => createTrigger("core.ItemStateUpdateTrigger", triggerName, {
            "itemName": itemName,
            "state": state
    }),    

    /**
     * Creates a trigger that fires upon an item receiving a command. Note that the item does not need to change state.
     * 
     * @example
     * ItemCommandTrigger('my_item', 'OFF')
     * 
     * @name ItemCommandTrigger
     * @memberof triggers
     * @param {String} itemName the name of the item to monitor for change
     * @param {String} [command] the command received
     * @param {String} [triggerName] the name of the trigger to create
     */
    ItemCommandTrigger: (itemName, command, triggerName) => createTrigger("core.ItemCommandTrigger", triggerName, {
        "itemName": itemName,
        "command": command
    }),

    /**
     * Creates a trigger that fires upon a member of a group changing state.
     * 
     * @example
     * GroupStateChangeTrigger('my_group', 'OFF', 'ON')
     * 
     * @name GroupStateChangeTrigger
     * @memberof triggers
     * @param {String} groupName the name of the group to monitor for change
     * @param {String} [oldState] the previous state of the group
     * @param {String} [newState] the new state of the group
     * @param {String} [triggerName] the name of the trigger to create
     */
    GroupStateChangeTrigger: (groupName, oldState, newState, triggerName) => createTrigger("core.GroupStateChangeTrigger", triggerName, {
        "groupName": groupName,
        "state": newState,
        "oldState": oldState
    }),

    /**
     * Creates a trigger that fires upon a member of a group receiving a state update. Note that group item does not need to change state.
     * 
     * @example
     * GroupStateUpdateTrigger('my_group', 'OFF')
     * 
     * @name GroupStateUpdateTrigger
     * @memberof triggers
     * @param {String} groupName the name of the group to monitor for change
     * @param {String} [state] the new state of the group
     * @param {String} [triggerName] the name of the trigger to create
     */
    GroupStateUpdateTrigger: (groupName, state, triggerName) => createTrigger("core.GroupStateUpdateTrigger", triggerName, {
        "groupName": groupName,
        "state": state
    }),

    /**
     * Creates a trigger that fires upon a member of a group receiving a command. Note that the group does not need to change state.
     * 
     * @example
     * GroupCommandTrigger('my_group', 'OFF')
     * 
     * @name GroupCommandTrigger
     * @memberof triggers
     * @param {String} groupName the name of the group to monitor for change
     * @param {String} [command] the command received
     * @param {String} [triggerName] the name of the trigger to create
     */
    GroupCommandTrigger: (groupName, command, triggerName) => createTrigger("core.GroupCommandTrigger", triggerName, {
        "groupName": groupName,
        "command": command
    }),

    /**
     * Creates a trigger that fires upon an Thing status updating
     * 
     * @example
     * ThingStatusUpdateTrigger('some:thing:uuid','OFFLINE')
     * 
     * @name ThingStatusUpdateTrigger
     * @memberof triggers
     * @param {String} thingUID the name of the thing to monitor for a status updating
     * @param {String} [status] the optional status to monitor for
     * @param {String} [triggerName] the name of the trigger to create
     */
    ThingStatusUpdateTrigger: (thingUID, status, triggerName) => createTrigger("core.ThingStatusUpdateTrigger", triggerName, {
        "thingUID": thingUID,
        "status": status,
    }),

    /**
    * Creates a trigger that fires upon an Thing status changing
    * 
    * @example
    * ThingStatusChangeTrigger('some:thing:uuid','ONLINE','OFFLINE')
    * 
    * @name ThingStatusChangeTrigger
    * @memberof triggers
    * @param {String} thingUID the name of the thing to monitor for a status change
    * @param {String} [status] the optional status to monitor for
    * @param {String} [previousStatus] the optional previous state to monitor from
    * @param {String} [triggerName] the optional name of the trigger to create
    */
    ThingStatusChangeTrigger: (thingUID, status, previousStatus, triggerName) => createTrigger("core.ThingStatusChangeTrigger", triggerName, {
        "thingUID": thingUID,
        "status": status,
        "previousStatus": previousStatus,
    }),

    /**
     * Creates a trigger that fires if a given start level is reached by the system
     * 
     * @example
     * SystemStartlevelTrigger(40)  //Rules loaded
     * ...
     * SystemStartlevelTrigger(50)  //Rule engine started
     * ...
     * SystemStartlevelTrigger(70)  //User interfaces started
     * ...
     * SystemStartlevelTrigger(80)  //Things initialized
     * ...
     * SystemStartlevelTrigger(100) //Startup Complete
     *
     * @name SystemStartlevelTrigger
     * @memberof triggers
     * @param {String} startlevel the system start level to be triggered on
     * @param {String} [triggerName] the name of the trigger to create
     */
    SystemStartlevelTrigger: (startlevel, triggerName) => createTrigger("core.SystemStartlevelTrigger", triggerName, {
        "startlevel": startlevel
    }),

    /**
     * Creates a trigger that fires on a cron schedule. The supplied cron expression defines when the trigger will fire.
     * 
     * @example
     * GenericCronTrigger('0 30 16 * * ? *')
     * 
     * @name GenericCronTrigger
     * @memberof triggers
     * @param {String} expression the cron expression defining the triggering schedule
     */
    GenericCronTrigger: (expression, triggerName) => createTrigger("timer.GenericCronTrigger", triggerName, {
        "cronExpression": expression
    }),    

    /**
     * Creates a trigger that fires daily at a specific time. The supplied time defines when the trigger will fire.
     * 
     * @example
     * TimeOfDayTrigger('19:00')
     * 
     * @name TimeOfDayTrigger
     * @memberof triggers
     * @param {String} time the time expression defining the triggering schedule
     */
    TimeOfDayTrigger: (time, triggerName) => createTrigger("timer.TimeOfDayTrigger", triggerName, {
        "time": time
    }),    

    /* not yet tested
    ItemStateCondition: (itemName, state, triggerName) => createTrigger("core.ItemStateCondition", triggerName, {
        "itemName": itemName,
        "operator": "=",
        "state": state
    }),
 
    GenericCompareCondition: (itemName, state, operator, triggerName) => createTrigger("core.GenericCompareCondition", triggerName, {
            "itemName": itemName,
            "operator": operator,// matches, ==, &lt;, >, =&lt;, =>
            "state": state
    })
    */
}
</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.7</a> on Wed Dec 08 2021 04:22:12 GMT+0000 (Coordinated Universal Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>



</body>
</html>
